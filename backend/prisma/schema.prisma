generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model AdminUser {
  id        String     @id @default(uuid())
  name      String
  email     String     @unique
  password  String
  role      Role       @default(ADMIN)
  isActive  Boolean    @default(true)
  createdAt DateTime   @default(now())
  auditLogs AuditLog[] @relation("ActorRelation")
}

model LoginLog {
  id        String   @id @default(uuid())
  email     String
  ip        String
  success   Boolean
  userAgent String?
  createdAt DateTime @default(now())
}

model AuditLog {
  id        String    @id @default(uuid())
  actorId   String
  targetId  String?
  action    String
  message   String?
  ip        String?
  userAgent String?
  createdAt DateTime  @default(now())
  actor     AdminUser @relation("ActorRelation", fields: [actorId], references: [id])
}

model Product {
  id            Int                   @id @default(autoincrement())
  name          String
  slug          String                @unique
  description   String?
  price         Float
  stock         Int                   @default(0)
  isPublished   Boolean               @default(true)
  brochure      String?
  specs         Json
  views         Int                   @default(0)
  brandId       Int?
  categoryId    Int?
  images        String[]
  createdAt     DateTime              @default(now())
  updatedAt     DateTime              @updatedAt
  brand         Brand?                @relation(fields: [brandId], references: [id])
  category      Category?             @relation(fields: [categoryId], references: [id])
  colors        ProductColor[]
  featureTags   ProductFeatureTag[]
  marketingTags ProductMarketingTag[]
}

model Brand {
  id        Int       @id @default(autoincrement())
  name      String    @unique
  image     String
  createdAt DateTime  @default(now())
  products  Product[]
}

model Category {
  id        Int       @id @default(autoincrement())
  name      String    @unique
  image     String
  icon      String
  createdAt DateTime  @default(now())
  products  Product[]
}

model FeatureTag {
  id       Int                 @id @default(autoincrement())
  name     String              @unique
  products ProductFeatureTag[]
}

model MarketingTag {
  id       Int                   @id @default(autoincrement())
  name     String                @unique
  products ProductMarketingTag[]
}

model ProductFeatureTag {
  productId Int
  tagId     Int
  product   Product    @relation(fields: [productId], references: [id], onDelete: Cascade)
  tag       FeatureTag @relation(fields: [tagId], references: [id], onDelete: Cascade)

  @@id([productId, tagId])
}

model ProductMarketingTag {
  productId Int
  tagId     Int
  product   Product      @relation(fields: [productId], references: [id], onDelete: Cascade)
  tag       MarketingTag @relation(fields: [tagId], references: [id], onDelete: Cascade)

  @@id([productId, tagId])
}

model Color {
  id       Int            @id @default(autoincrement())
  name     String
  hexCode  String         @unique
  products ProductColor[]
}

model ProductColor {
  productId Int
  colorId   Int
  color     Color   @relation(fields: [colorId], references: [id], onDelete: Cascade)
  product   Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@id([productId, colorId])
}

model AdBanner {
  id        Int      @id @default(autoincrement())
  images    String[]
  createdAt DateTime @default(now())
  link      String?
}

model Blog {
  id         Int      @id @default(autoincrement())
  title      String
  content    String
  author     String   @default("admin")
  images     String[]
  slug       String   @default("untitles")
  metadata   Json     @default("{}")
  createdAt  DateTime @default(now())
  updateedAt DateTime @default(now())
}

enum Role {
  SUPERADMIN
  ADMIN
}
